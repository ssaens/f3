parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"PVdp":[function(require,module,exports) {
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function t(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o=function(){function n(){e(this,n),this.mouse={x:0,y:0},this.keys=new Set,this.handlers={},this.on_click=this.on_click.bind(this),this.on_mouse=this.on_mouse.bind(this),this.on_scroll=this.on_scroll.bind(this),this.init()}return t(n,[{key:"init",value:function(){window.addEventListener("mousemove",this.on_mouse)}},{key:"destroy",value:function(){window.removeEventListener("mousemove",this.on_mouse)}},{key:"on",value:function(e,n){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(n)}},{key:"remove",value:function(e,n){this.handlers[e]&&(this.handlers[e]=this.handlers[e].filter(function(e){return e!==n}))}},{key:"on_click",value:function(){}},{key:"on_mouse",value:function(e){var n=this;this.mouse.x=e.offsetX,this.mouse.y=e.offsetY,this.handlers.mousemove.forEach(function(t){return t(n,e)})}},{key:"on_scroll",value:function(){}}]),n}();exports.default=o;
},{}],"3fHx":[function(require,module,exports) {
"use strict";function t(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function r(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.to_half=exports.Program=exports.Texture=void 0;var n=function(){function r(e){t(this,r),this.gl=e,this._tex=e.createTexture(),this.bind();for(var n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];e.texImage2D.apply(e,[e.TEXTURE_2D].concat(a)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}return e(r,[{key:"bind",value:function(){var t=this.gl,r=this._tex;t.bindTexture(t.TEXTURE_2D,r)}},{key:"unbind",value:function(){var t=this.gl;t.bindTexture(t.TEXTURE_2D,null)}}]),r}();exports.Texture=n;var a=function(){function r(){t(this,r)}return e(r,null,[{key:"load",value:function(t,r,e){var n=t.createShader(r);if(t.shaderSource(n,e),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS))return n;var a=t.getShaderInfoLog(n);throw t.deleteShader(n),new Error("An error occurred compiling a shader: ".concat(a))}}]),r}(),o=function(){function r(e,n,o,i,u){var s=this;t(this,r),this.name=n,this.vert=a.load(e,e.VERTEX_SHADER,o),this.frag=a.load(e,e.FRAGMENT_SHADER,i);var c=e.createProgram();if(e.attachShader(c,this.vert),e.attachShader(c,this.frag),e.linkProgram(c),!e.getProgramParameter(c,e.LINK_STATUS))throw new Error("Unable to link the shader program ".concat(n,": ").concat(e.getProgramInfoLog(c)));this.attrs={},this.uniforms={},u.attrs&&u.attrs.forEach(function(t){s.attrs[t]=e.getAttribLocation(c,t),-1===s.attrs[t]&&console.warn("shader attribute ".concat(t," in program ").concat(n," not found"))}),u.uniforms&&u.uniforms.forEach(function(t){s.uniforms[t]=e.getUniformLocation(c,t),-1===s.uniforms[t]&&console.warn("shader uniform ".concat(t," in program ").concat(n," not found"))}),this.type_to_uniform_map=r.build_type_to_uniform_func_map(e),this.gl=e,this.pid=c}return e(r,[{key:"set_attr",value:function(t){var r,e=this.attrs[t];if(void 0===e)return!1;for(var n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];(r=this.gl).vertexAttribPointer.apply(r,[e].concat(a)),this.gl.enableVertexAttribArray(e)}},{key:"set_uniform",value:function(t){this.use();var r=this.gl,e=this.type_to_uniform_map,n=this.uniforms[t];if(void 0===n)return!1;for(var a=r.getActiveUniform(this.pid,n),o=arguments.length,i=new Array(o>1?o-1:0),u=1;u<o;u++)i[u-1]=arguments[u];e[a].apply(e,i),this.unuse()}},{key:"use",value:function(){this.gl.useProgram(this.pid)}},{key:"unuse",value:function(){this.gl.useProgram(null)}}],[{key:"build_type_to_uniform_func_map",value:function(t){}}]),r}();exports.Program=o;var i=function(){var t=new Float32Array(1),r=new Int32Array(t.buffer);return function(e){t[0]=e;var n=r[0],a=n>>16&32768,o=n>>12&2047,i=n>>23&255;return i<103?a:i>142?(a|=31744,a|=(255==i?0:1)&&8388607&n):i<113?a|=((o|=2048)>>114-i)+(o>>113-i&1):(a|=i-112<<10|o>>1,a+=1&o)}}();exports.to_half=i;
},{}],"DdlQ":[function(require,module,exports) {
module.exports="#version 300 es\n#define GLSLIFY 1\nlayout(location = 0) in float id;\n\nout vec3 pos;\nflat out float _id;\n\nuniform uint num_particles;\nuniform mediump float radius;\nuniform sampler2D pos_buf;\n\nvoid main() {\n  vec2 in_pos = texture(pos_buf, vec2(id / float(num_particles), 0)).xy;\n  vec3 p = vec3(in_pos, 0.f);\n  gl_Position = vec4(p, 1.f);\n\n  gl_PointSize = radius;\n\n  pos = p;\n  _id = id;\n}\n";
},{}],"4iW5":[function(require,module,exports) {
module.exports="#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\nin vec3 pos;\nflat in float _id;\n\nout vec4 f_color;\n\nuniform mediump float radius;\nuniform lowp float t;\nuniform lowp vec2 mouse;\n\nconst vec3 lpos = vec3(0.f, 0.f, 1.f);\nconst vec3 ambient = vec3(0.05f, 0.2f, 0.3f);\nconst vec3 color = vec3(0.15f, 0.65f, 1.f);\n\nvoid main() {\n  vec3 n;\n  n.xy = 2.f * gl_PointCoord.st - vec2(1.f);\n  n.y = -n.y;\n  float r2 = length(n.xy);\n  if (r2 > 1.f)\n    discard;\n\n  n.z = sqrt(1.f - r2);\n\n  vec2 n_mouse = 2.f * vec2(mouse.x, -mouse.y) - vec2(1.f, -1.f);\n\n  vec3 lpos_curr = vec3(n_mouse, 1.f);\n  float diffuse = clamp(dot(n, lpos_curr - pos), 0.f, 1.f);\n\n  f_color = vec4(ambient + diffuse * color.xyz, 1.f);\n}";
},{}],"EQ8R":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("~/src/gl-util"),r=i(require("~/glsl/pbd.vert")),t=i(require("~/glsl/pbd.frag"));function i(e){return e&&e.__esModule?e:{default:e}}function n(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},i=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.forEach(function(r){u(e,r,t[r])})}return e}function u(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function s(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function a(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,r,t){return r&&a(e.prototype,r),t&&a(e,t),e}var l=function(i,u){return function(){function a(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];s(this,a),this.particle_radius=16,this.info={},this.textures={},this.framebuffer=null,this.framebuffers=[],this.next_id=-1,this.particles=[],this.textures={meta:null,pos:null,vel:null,pred_pos:null,temp:null,density_lambda:null},this.init()}return o(a,[{key:"init",value:function(){var e=this.generate_particles({d_x:30,d_y:15});i.info=n({},i.info,{particles:this.num_particles}),this.init_programs(),this.init_textures(e),this.program.use(),u.uniform1f(this.program.uniforms.radius,i.is_mac?2*this.particle_radius:this.particle_radius),u.uniform1i(this.program.uniforms.pos_buf,0),u.uniform1ui(this.program.uniforms.num_particles,this.num_particles);var r=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,r),u.bufferData(u.ARRAY_BUFFER,new Uint16Array(this.particles),u.STATIC_DRAW),this.program.set_attr("id",1,u.UNSIGNED_SHORT,!1,0,0),u.bindBuffer(u.ARRAY_BUFFER,null),this.program.unuse()}},{key:"generate_particles",value:function(e){for(var r=e.o_x,t=void 0===r?0:r,i=e.o_y,n=void 0===i?0:i,u=e.w,s=void 0===u?1:u,a=e.h,o=void 0===a?1:a,l=e.d_x,f=void 0===l?10:l,c=e.d_y,p=[],m=s*f,h=o*(void 0===c?10:c),d=s/m,_=o/h,g=-m/2;g<m/2;++g)for(var v=-h/2;v<h/2;++v){p.push(t+g*d,n+v*_),this.particles.push(++this.next_id)}return p}},{key:"init_programs",value:function(){this.program=new e.Program(u,"basic",r.default,t.default,{attrs:["id"],uniforms:["t","radius","mouse","pos_buf","num_particles"]})}},{key:"init_textures",value:function(r){var t=new e.Texture(u,0,u.RG16F,this.num_particles,1,0,u.RG,u.HALF_FLOAT,new Uint16Array(r.map(e.to_half)));this.textures.pos=t,u.activeTexture(u.TEXTURE0),t.bind()}},{key:"step",value:function(e){}},{key:"render",value:function(){var e=i.canvas,r=i.input,t=i.is_mac,n=i.renderer;u.viewport(0,0,e.width,e.height),this.program.use(),u.uniform1f(this.program.uniforms.t,n.t_curr),t?u.uniform2f(this.program.uniforms.mouse,2*r.mouse.x/e.width,2*r.mouse.y/e.height):u.uniform2f(this.program.uniforms.mouse,r.mouse.x/e.width,r.mouse.y/e.height),u.drawArrays(u.POINTS,0,this.num_particles),this.program.unuse()}},{key:"num_particles",get:function(){return this.particles.length}}]),a}()};exports.default=l;
},{"~/src/gl-util":"3fHx","~/glsl/pbd.vert":"DdlQ","~/glsl/pbd.frag":"4iW5"}],"xVhK":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var i=function(){function t(){e(this,t);var n=document.createElement("div");n.setAttribute("id","info-box"),n.style.position="fixed",n.style.top=0,n.style.left=0,n.style.border="1px solid white",n.style.color="white",n.style.padding="0.4em",n.style.fontSize="0.8em",document.body.appendChild(n),this.div=n,this._info={}}return n(t,[{key:"info",get:function(){return this._info},set:function(e){this._info=e,this.div.innerHTML="<pre>".concat(JSON.stringify(e,null,2),"</pre>")}}]),t}();exports.default=i;
},{}],"J3mu":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=function(t,n){return function(){function r(){e(this,r),this.running=!1,this.avg_fps=0,this.t_curr=0,this.t_last=0,this.on_frame=this.on_frame.bind(this),this.on_resize=this.on_resize.bind(this)}return i(r,[{key:"init",value:function(){n.clearColor(.2,.2,.2,1),n.clearDepth(1),n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL),window.addEventListener("resize",this.on_resize)}},{key:"start",value:function(){this.running=!0,window.requestAnimationFrame(this.on_frame)}},{key:"on_frame",value:function(e){if(this.running){n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),this.t_last=this.t_curr,this.t_curr=e;var i=e-this.t_last;this.avg_fps=.5*(1e3/i+this.avg_fps),t.sim.step(i),t.sim.render(),window.requestAnimationFrame(this.on_frame)}}},{key:"on_resize",value:function(){var e=t.canvas;t.is_mac?(e.height=2*e.clientHeight,e.width=2*e.clientWidth):(e.height=e.clientHeight,e.width=e.clientWidth)}},{key:"pause",value:function(){this.running=!1}},{key:"destroy",value:function(){}}]),r}()};exports.default=n;
},{}],"m9zS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("./input-manager")),t=r(require("./sim")),i=r(require("./ui-interface")),n=r(require("./renderer"));function r(e){return e&&e.__esModule?e:{default:e}}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){s(e,t,i[t])})}return e}function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,i){return t&&u(e.prototype,t),i&&u(e,i),e}var l=function(){function r(t){if(a(this,r),this.canvas=document.getElementById(t),!this.canvas)throw new Error("canvas element not found");this.initialized=!1,this.paused=!0,this.is_mac=/mac/i.test(window.navigator.platform),this.gl=null,this.sim=null,this.renderer=null,this.input=new e.default,this.info_box=new i.default,this.sample_performance=this.sample_performance.bind(this),this.on_mousemove=this.on_mousemove.bind(this),this.input.on("mousemove",this.on_mousemove)}return f(r,[{key:"init",value:function(){this.info_box.info={state:"initializing..."};var e=this.canvas.getContext("webgl2");if(!e)throw new Error("webgl context could not be created");this.gl=e,this.sim=new((0,t.default)(this,e)),this.renderer=new((0,n.default)(this,e)),this.renderer.init(),this.renderer.on_resize(),this.initialized=!0,this.info=o({},this.info,{state:"initialized"})}},{key:"on_mousemove",value:function(e){this.info=o({},this.info,{mouse:"".concat(e.mouse.x,", ").concat(e.mouse.y)})}},{key:"run",value:function(){if(!this.initialized)throw new Error("application has not been initialized");this.paused=!1,this.info=o({},this.info,{state:"running"}),this.renderer.start(),window.setTimeout(this.sample_performance,1e3)}},{key:"sample_performance",value:function(){if(this.renderer.running){this.t,this.tLast;this.info=o({},this.info,{fps:"".concat(this.renderer.avg_fps.toFixed(2)," fps")}),window.setTimeout(this.sample_performance,1e3)}}},{key:"pause",value:function(){this.info=o({},this.info,{state:"paused"}),delete this.info.fps,this.renderer.pause()}},{key:"info",get:function(){return this.info_box.info},set:function(e){this.info_box.info=e}}]),r}();exports.default=l;
},{"./input-manager":"PVdp","./sim":"EQ8R","./ui-interface":"xVhK","./renderer":"J3mu"}],"HJD/":[function(require,module,exports) {
"use strict";var e=u(require("./app"));function u(e){return e&&e.__esModule?e:{default:e}}function n(){var u=new e.default("view");u.init(),u.run()}n();
},{"./app":"m9zS"}]},{},["HJD/"], null)
//# sourceMappingURL=docs/main.e00f3392.js.map